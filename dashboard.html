<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Trash Scan</title>

<!-- JANGAN PAKAI latest -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.15.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

<style>

body{
margin:0;
font-family:Arial;
background:linear-gradient(135deg,#ffd6c9,#ffb7a5,#ffe5dc);
}

header{
background:white;
padding:15px;
display:flex;
justify-content:center;
align-items:center;
box-shadow:0 5px 10px rgba(0,0,0,.08);
font-weight:bold;
}

main{
padding:20px;
max-width:600px;
margin:auto;
}

.card{
background:white;
padding:20px;
border-radius:18px;
box-shadow:0 10px 25px rgba(0,0,0,.1);
margin-bottom:15px;
display:flex;
justify-content:space-between;
align-items:center;
cursor:pointer;
}

.icon{
background:#ffb7a5;
color:white;
width:40px;
height:40px;
border-radius:10px;
display:flex;
align-items:center;
justify-content:center;
}

.btn{
background:#ff9a82;
color:white;
border:none;
padding:12px;
width:100%;
border-radius:12px;
margin-top:15px;
cursor:pointer;
}

.hidden{display:none;}

.upload{
border:2px dashed #ffb7a5;
border-radius:14px;
padding:25px;
text-align:center;
cursor:pointer;
}

.upload img{
max-width:100%;
margin-top:10px;
border-radius:12px;
}

.result{
background:#fff0ea;
padding:15px;
border-radius:14px;
margin-top:10px;
display:none;
}

.box{
background:white;
padding:20px;
border-radius:16px;
box-shadow:0 10px 20px rgba(0,0,0,.1);
margin-bottom:15px;
}

</style>
</head>

<body>

<header class="hero">
  <div class="hero-title">
    <div class="logo">â™»</div>
    <div>
      <h1>Welcome to the Digital Waste Detector website</h1>
      <p>Sistem Pengelolaan Sampah Sekolah Berbasis Teknologi</p>
    </div>
  </div>
</header>

<main id="dashboard">

<div class="card" onclick="openScan()">
<div><b>Scan Sampah</b></div>
<div class="icon">ğŸ“·</div>
</div>

<div class="card" onclick="openJenis()">
<div><b>Jenis Sampah</b></div>
<div class="icon">ğŸ“š</div>
</div>

<div class="card" onclick="openRekomendasi()">
<div><b>Hasil & Rekomendasi</b></div>
<div class="icon">â™»</div>
</div>

</main>

<main id="scan" class="hidden">
<div class="box">

<h3>Upload Gambar Sampah</h3>

<label class="upload" for="imageInput">
Klik Upload Gambar
<input id="imageInput" type="file" accept="image/*">
<img id="preview">
</label>





<button class="btn" onclick="predict()">Mulai Scan</button>

<div class="result" id="result">
<b id="label"></b>
<p id="confidence"></p>
</div>

<div class="result" id="inlineRekom">
<b id="inlineJenis"></b>
<div id="inlineText"></div>
</div>

<button class="btn" onclick="back()">Kembali</button>

</div>
</main>

<main id="jenis" class="hidden">
<div class="box">
<p>ğŸŸ¢ Organik</p>
<p>ğŸŸ  Anorganik</p>
<p>ğŸ”µ B3</p>
<button class="btn" onclick="back()">Kembali</button>
</div>
</main>

<main id="rekomendasi" class="hidden">
<div class="box">
<b id="hasilScan"></b>
<div id="rekomText"></div>
<button class="btn" onclick="back()">Kembali</button>
</div>
</main>

<script>

const URL="./model/";

let model,lastResult="";

window.onload=async()=>{
  const cameraInput = document.getElementById("cameraInput");

cameraInput.onchange = e => {
  const file = e.target.files[0];
  if(!file) return;

  const reader = new FileReader();
  reader.onload = () => {
    preview.src = reader.result;
  };
  reader.readAsDataURL(file);
};

  const imageInput = document.getElementById("imageInput");
const preview = document.getElementById("preview");
const label = document.getElementById("label");
const confidence = document.getElementById("confidence");
const inlineText = document.getElementById("inlineText");
const inlineJenis = document.getElementById("inlineJenis");
const result = document.getElementById("result");
const inlineRekom = document.getElementById("inlineRekom");
const hasilScan = document.getElementById("hasilScan");
const rekomText = document.getElementById("rekomText");


const dashboard=document.getElementById("dashboard");
const scan=document.getElementById("scan");
const jenis=document.getElementById("jenis");
const rekomendasi=document.getElementById("rekomendasi");

window.openScan=()=>{dashboard.classList.add("hidden");scan.classList.remove("hidden");}
window.openJenis=()=>{dashboard.classList.add("hidden");jenis.classList.remove("hidden");}
window.openRekomendasi=()=>{
  dashboard.classList.add("hidden");
  rekomendasi.classList.remove("hidden");

  if(!lastResult){
    hasilScan.innerHTML = "Belum ada hasil scan";
    rekomText.innerHTML = `
      ğŸ“¸ Silakan lakukan scan sampah terlebih dahulu<br>
      â™» Setelah scan, rekomendasi akan muncul di sini
    `;
  }else{
    hasilScan.innerHTML = "Jenis Sampah: " + lastResult;
    rekomText.innerHTML = inlineText.innerHTML;
  }
}

window.back=()=>{
scan.classList.add("hidden");
jenis.classList.add("hidden");
rekomendasi.classList.add("hidden");
dashboard.classList.remove("hidden");
}

imageInput.onchange = e => {
const file = e.target.files[0];
if(!file) return;

const reader = new FileReader();

reader.onload = () => {
preview.src = reader.result;
};

reader.readAsDataURL(file);
};


try{
model=await tmImage.load(URL+"model.json",URL+"metadata.json");
alert("MODEL SIAP");
}catch(e){
alert("MODEL GAGAL LOAD");
console.error(e);
}

};

async function predict(){

if(!model) return alert("Model belum siap");
if(!preview.src) return alert("Pilih gambar dulu");

const p=await model.predict(preview);
p.sort((a,b)=>b.probability-a.probability);

lastResult=p[0].className;

label.innerText=lastResult;
confidence.innerText="Akurasi "+(p[0].probability*100).toFixed(2)+"%";

result.style.display="block";
inlineRekom.style.display="block";
inlineJenis.innerHTML="Jenis Sampah: "+lastResult;
const resultText = lastResult.toLowerCase();


if(resultText === "organik"){


  inlineText.innerHTML = `
  ğŸŸ¢ <b>Jenis:</b> Sampah Organik<br>
  âœ… Kompos<br>
  âœ… Pakan ternak<br>
  âœ… Biopori<br>
  âœ… Eco enzyme
  `;
}
else if(resultText === "anorganik"){

  inlineText.innerHTML = `
  ğŸŸ  <b>Jenis:</b> Sampah Anorganik<br>
  â™» Daur ulang<br>
  â™» Bank sampah<br>
  â™» Ecobrick<br>
  â™» Kerajinan
  `;
} 
else if(resultText === "b3"){

  inlineText.innerHTML = `
  ğŸ”´ <b>Jenis:</b> Sampah B3<br>
  âš  Jangan dibakar<br>
  âš  Jangan dibuang sembarangan<br>
  âš  Kirim ke TPS khusus B3
  `;
}

else{
  inlineText.innerHTML = `
  â“ Jenis sampah tidak dikenali<br>
  ğŸ” Silakan pisahkan manual
  `;
}

}

</script>

</body>
</html>








